category: Case Management
commonfields:
  id: SOCaaS-MSS Portal
  version: -1
configuration:
- defaultvalue: https://tssapi-preprod.telus.com
  display: Server URL (e.g. 'https://tssapi-preprod.telus.com)
  name: url
  required: true
  type: 0
- additionalinfo: This parameter does not have any effect since v1 will be added automatically
    into api url
  defaultvalue: v1
  display: Currently, we use v1 of MSS Portal API
  name: api_versionv
  required: true
  type: 0
- display: MSS Portal API Key
  name: api_key
  required: true
  type: 0
- defaultvalue: "false"
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: "true"
  display: Fetch indicators
  name: feed
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This is the MSS Portal integration.
detaileddescription: |
  ### Partner Contributed Integration
  #### Integration Author: Doo Yul Kim
  Support and maintenance for this integration are provided by the author. Please use the following contact details:
  - **Email**: [doo_yul.kim@telus.copm](mailto:doo_yul.kim@telus.copm)
  ***
  ## BaseIntegration Help

  Markdown file for integration configuration  help snippet. In this file add:

  - Brief information about how to retrieve the API key of your product
  - Other useful information on how to configure your integration in XSOAR

  Since this is a Markdown file, we encourage you to use MD formatting for sections, sub-sections, lists, etc.
display: SOCaaS-MSS Portal
image: data:image/png;base64,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
name: SOCaaS-MSS Portal
script:
  commands:
  - arguments:
    - description: case ID to return
      name: id
      required: true
    description: 'mssportal-acknowledge-case command: Change case status from ''pending''
      to ''Investigate'''
    name: mssportal-acknowledge-case
  - arguments:
    - description: case ID to return
      name: id
      required: true
    description: 'mssportal-confirm-incident command: confirms the case as a true
      incident'
    name: mssportal-confirm-incident
  - arguments:
    - description: Source  ID ex) CORTEX XDR
      name: sourceId
      required: true
    - description: Source alert created date . Format) 2022-07-18T13:44:36.769Z (ISO
      name: sourceCreatedAt
      required: true
    - description: Source alert modified date Source.  Format )
      name: sourceModifiedAt
      required: true
    - description: Source Alert ID
      name: sourceAlertId
      required: true
    - description: Source raw data in JSON
      name: sourceRaw
      required: true
    - description: ID to return
      name: severity
      required: true
    - description: Customer's ID ex)123475
      name: customerId
      required: true
    - description: related case investigation id
      name: investigationCaseId
      required: true
    - description: name of the alert
      name: name
      required: true
    - description: Related case description
      name: caseDescription
      required: true
    - description: Related case title
      name: caseTitle
      required: true
    - description: The HTML representation of the alert
      name: detailHtml
    description: 'mssportal-create-alert command: Returns a MSSPortal alert'
    name: mssportal-create-alert
    outputs:
    - contextPath: MSSPortal.Alert.id
      description: The ID of the new alert
      type: Number
    - contextPath: MSSPortal.Alert.createdAt
      description: The creation time of the new alert
      type: Unknown
    - contextPath: MSSPortal.Alert.sourceId
      description: undefined
      type: String
    - contextPath: MSSPortal.Alert.sourceCreatedAt
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.sourceModifiedAt
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.sourceAlertId
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.sourceRaw
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.severity
      description: severity of the alert
      type: Unknown
    - contextPath: MSSPortal.Alert.customerId
      description: The ID of the related case
      type: Number
    - contextPath: MSSPortal.Alert.investigationCaseId
      description: The  ID of the related case
      type: Unknown
    - contextPath: MSSPortal.Alert.acknowledgedBy
      description: The alert was acknowledgedBy
      type: Unknown
    - contextPath: MSSPortal.Alert.acknowledgedAt
      description: The alert was acknowledgedAt
      type: Unknown
    - contextPath: MSSPortal.Alert.name
      description: Alert name
      type: Unknown
    - contextPath: MSSPortal.Alert.detailHTML
      description: unknown
      type: Unknown
    - contextPath: MSSPortal.Alert.providerId
      description: The ID of the source system
      type: Unknown
    - contextPath: MSSPortal.Alert.providerCreatedAt
      description: The creation timestamp in the source system
      type: Unknown
    - contextPath: MSSPortal.Alert.providerModifiedAt
      description: The modification timestamp in the source system
      type: Unknown
    - contextPath: MSSPortal.Alert.providerAlertId
      description: ""
      type: Unknown
  - arguments:
    - description: Status of case
      name: status
    - description: Telus user accountable for case
      name: telusPrime
    - description: description of case
      name: description
      required: true
    - description: Title of case
      name: caseTitle
      required: true
    - description: Priority of case (HIGH, MEDIUM, LOW)
      name: priority
      required: true
    - description: Customer's ID ex)123475
      name: customerId
      required: true
    - description: resolution notes of the case
      name: caseSource
      required: true
    - description: resolution notes of the case
      name: resolutionNotes
    - description: The component of service for the case . EX) SOC
      name: serviceComponent
      required: true
    description: 'mssportal-create-case command: Returns a MSSPortal case'
    name: mssportal-create-case
    outputs:
    - contextPath: MSSPortal.Case.id
      description: ID of the case
      type: Number
    - contextPath: MSSPortal.Case.status
      description: status of the case
      type: String
    - contextPath: MSSPortal.Case.telusPrime
      description: telus user accountable for case
      type: String
    - contextPath: MSSPortal.Case.description
      description: description of the case
      type: String
    - contextPath: MSSPortal.Case.caseTitle
      description: Title of the case
      type: String
    - contextPath: MSSPortal.Case.priority
      description: severity of case (HIGH, MEIDUM, LOW )
      type: String
    - contextPath: MSSPortal.Case.resolutionNotes
      description: resolution notes of the case
      type: String
    - contextPath: MSSPortal.Case.customerId
      description: Portal customer ID
      type: Number
    - contextPath: MSSPortal.Case.caseSource
      description: Source of the case
      type: unknown
    - contextPath: MSSPortal.Case.alertName
      description: Name of the alert
      type: String
    - contextPath: MSSPortal.Case.createdAt
      description: Time case was created at
      type: date
    - contextPath: MSSPortal.Case.createdBy
      description: modifier of the case
      type: String
    - contextPath: MSSPortal.Case.updatedAt
      description: time of most recent update
      type: date
    - contextPath: MSSPortal.Case.updatedBy
      description: who the case was updated by
      type: string
    - contextPath: MSSPortal.Case.serviceComponent
      description: Service Component Ex)SOC
      type: unknown
    - contextPath: MSSPortal.Case.incident
      description: Indicator for true incident
      type: boolean
    - contextPath: MSSPortal.Case.incidentTime
      description: Time of the incident creation
      type: date
    - contextPath: MSSPortal.Case.nbTelusPendingTasks
      description: number of pending tasks for telus
      type: number
    - contextPath: MSSPortal.Case.nbTelusUnreadTaskComments
      description: tasks unread by customer
      type: number
    - contextPath: MSSPortal.Case.nbCustomerClosedTasks
      description: closed tasks
      type: number
    - contextPath: MSSPortal.Case.nbCustomerTasks
      description: customer tasks
      type: number
    - contextPath: MSSPortal.Case.resolvedAt
      description: when the task was resolved
      type: date
    - contextPath: MSSPortal.Case.resolvedBy
      description: who resolved the task
      type: string
    - contextPath: MSSPortal.Case.sourceCreatedAt
      description: undefined
      type: unknown
    - contextPath: MSSPortal.Case.firstAcknowledgmentAt
      description: task was first acknowledged
      type: date
    - contextPath: MSSPortal.Case.firstAssignmentAt
      description: unknown
      type: unknown
    - contextPath: MSSPortal.Case.firstResolutionAt
      description: unknown
      type: undefined
    - contextPath: MSSPortal.Case.firstCustomerIncidentTaskCreatedAt
      description: time customer created first incident task
      type: date
    - contextPath: MSSPortal.Case.firstCustomerTaskCreatedAt
      description: unknown
      type: undefined
    - contextPath: MSSPortal.Case.firstTelusIncidentTaskResolvedAt
      description: first time TELUS resolved task
      type: date
    - contextPath: MSSPortal.Case.firstTelusTaskResolvedAt
      description: time first task resolved at by TELUS
      type: date
  - arguments:
    - description: playbook name
      name: name
    - description: playbook description
      name: description
    description: 'mssportal-create-playbook command: Returns a MSSPortal playbook'
    name: mssportal-create-playbook
    outputs:
    - contextPath: MSSPortal.Playbook.id
      description: playbook id
      type: number
    - contextPath: MSSPortal.Playbook.name
      description: playbook name
      type: string
    - contextPath: MSSPortal.Playbook.createdAt
      description: time of creation
      type: date
    - contextPath: MSSPortal.Playbook.createdBy
      description: who was playbook was created by
      type: string
    - contextPath: MSSPortal.Playbook.description
      description: description of playbook
      type: string
    - contextPath: MSSPortal.Playbook.playbookTasks
      description: playbook tasks
      type: unknown
    - contextPath: MSSPortal.Playbook.updatedAt
      description: time playbook was updated
      type: date
    - contextPath: MSSPortal.Playbook.updatedBy
      description: who updated playbook
      type: string
  - arguments:
    - description: Task name
      name: name
    - description: Task description
      name: description
    - description: Id of the case
      name: caseId
    - description: 'Telus user accountable for task example: TELUS'
      name: accountable
    - description: 'The Telus user accountable for the case example: https://mssportal.telus.com/api/users/1'
      name: telusPrime
    - description: The priority of the task ex HIGH, MEDIUM, LOW
      name: priority
    - description: The phase of the task ex Investigate
      name: phase
    - description: The status of the task ex pending
      name: status
    - description: The due date of the task
      name: dueDate
    - description: The threshold in days to notify when task will expire
      name: aboutToExpireThresholdInDays
    - description: Should the customer be notified when TELUS modifies a task (ex
        false or true)
      name: modifiedByTelus
    description: 'mssportal-create-task command: Returns a MSSPortal task'
    name: mssportal-create-task
    outputs:
    - contextPath: MSSPortal.Task.id
      description: Playbook id
      type: Number
    - contextPath: MSSPortal.Task.name
      description: name of the task
      type: String
    - contextPath: MSSPortal.Task.description
      description: description of the task
      type: String
    - contextPath: MSSPortal.Task.caseId
      description: case no.
      type: Number
    - contextPath: MSSPortal.Task.customerId
      description: undefined
      type: Number
    - contextPath: MSSPortal.Task.accountable
      description: who is accountable TELUS or customer
      type: String
    - contextPath: MSSPortal.Task.status
      description: status of task
      type: String
    - contextPath: MSSPortal.Task.acknowledged
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.priority
      description: priority of task
      type: Unknown
    - contextPath: MSSPortal.Task.phase
      description: undefined
      type: String
    - contextPath: MSSPortal.Task.telusPrime
      description: The Telus user accountable for the case
      type: String
    - contextPath: MSSPortal.Task.dueDate
      description: due date of case
      type: Unknown
    - contextPath: MSSPortal.Task.createdAt
      description: time of creation
      type: Unknown
    - contextPath: MSSPortal.Task.createdBy
      description: who created the task
      type: Unknown
    - contextPath: MSSPortal.Task.updatedAt
      description: last updated
      type: Unknown
    - contextPath: MSSPortal.Task.updatedBy
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.acknowledgedAt
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.acknowledgedBy
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.caseTitle
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.playbookName
      description: name of playbook
      type: String
    - contextPath: MSSPortal.Task.comments
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.unreadCommentsByCustomer
      description: no. of unread comments by customer
      type: Number
    - contextPath: MSSPortal.Task.unreadCommentsByTelus
      description: no. of unread comments by TELUS
      type: Number
    - contextPath: MSSPortal.Task.modifiedbyTelus
      description: notify customer when TELUS updates task (true or false)
      type: Unknown
    - contextPath: MSSPortal.Task.resolvedAt
      description: Resolution time of the task
      type: Unknown
    - contextPath: MSSPortal.Task.resolvedBy
      description: undefined
      type: String
  - arguments:
    - description: Alert ID to return
      name: id
      required: true
    description: 'mssportal-get-alert command: Returns a MSSPortal alert'
    name: mssportal-get-alert
    outputs:
    - contextPath: MSSPortal.Alert.id
      description: Alert ID.
      type: Number
    - contextPath: MSSPortal.Alert.created_At
      description: Alert created time. Format is ISO8601 (i.e. '2020-04-30T10:35:00.000Z').
      type: Unknown
    - contextPath: MSSPortal.Alert.providerId
      description: Alert description.
      type: String
    - contextPath: MSSPortal.Alert.providerCreatedAt
      description: ID of the device involved in the alert.
      type: Unknown
    - contextPath: MSSPortal.Alert.providerModifiedAt
      description: IP Address of the device involved in the alert.
      type: Unknown
    - contextPath: MSSPortal.Alert.providerAlertId
      description: Location of the device involved in the alert.
      type: Unknown
    - contextPath: MSSPortal.Alert.providerRaw
      description: User involved in the alert.
      type: Unknown
    - contextPath: MSSPortal.Alert.severity
      description: Alert severity. Can be 'Low', 'Medium', 'High' or 'Critical'
      type: Unknown
    - contextPath: MSSPortal.Alert.customerId
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.investigationCaseId
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.acknowledgedBy
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.acknowledgedAt
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Alert.name
      description: undefined
      type: Unknown
  - arguments:
    - description: playbook id
      name: playbookId
    - description: Start time of source playbook creation date . Format) 2022-07-18T13:44:36.769Z
        (ISO
      name: createdAt_from
    - description: End time of source playbook creation date . Format) 2022-07-18T13:44:36.769Z
        (ISO
      name: createdAt_to
    - description: Start time of playbook update . Format) 2022-07-18T13:44:36.769Z
        (ISO
      name: updatedAt_to
    - description: Start time of playbook update. Format) 2022-07-18T13:44:36.769Z
        (ISO
      name: updatedAt_from
    - description: End time of playbook update. Format) 2022-07-18T13:44:36.769Z (ISO
      name: updatedAt_to
    - description: keyword
      name: searchText
    - description: undefined
      name: sort
    - default: true
      description: undefined
      name: offset
    - default: true
      description: limit number of playbook results
      name: limit
    description: 'mssportal-find-playbook command: Returns a MSSPortal Playbook'
    name: mssportal-find-playbook
    outputs:
    - contextPath: MSSPortal.Playbook.totalPages
      description: undefined
      type: integer
    - contextPath: MSSPortal.Playbook.totalElements
      description: total number of Playbooks
      type: integer
    - contextPath: MSSPortal.Playbook.number
      description: undefined
      type: integer
    - contextPath: MSSPortal.Playbook.sort
      description: unknown
      type: unknown
    - contextPath: MSSPortal.Playbook.content
      description: Playbook information (id, name, description, caseId, customerId,
        status, comments, etc)
      type: unknown
    - contextPath: MSSPortal.Playbook.numberOfElements
      description: undefined
      type: integer
    - contextPath: MSSPortal.Playbook.pageable
      description: undefined
      type: unknown
    - contextPath: MSSPortal.Playbook.first
      description: undefined
      type: boolean
    - contextPath: MSSPortal.Playbook.last
      description: undefined
      type: boolean
    - contextPath: MSSPortal.Playbook.empty
      description: undefined
      type: boolean
  - arguments:
    - description: Case ID to return
      name: case_id
      required: true
    description: 'mssportal-get-case command: Returns a MSSPortal case'
    name: mssportal-get-case
    outputs:
    - contextPath: MSSPortal.Case.id
      description: Alert ID.
      type: Number
    - contextPath: MSSPortal.Case.status
      description: 'status of case example: PENDING'
      type: String
    - contextPath: MSSPortal.Case.telusPrime
      description: The Telus user accountable for the case
      type: String
    - contextPath: MSSPortal.Case.description
      description: The description of the case
      type: String
    - contextPath: MSSPortal.Case.caseTitle
      description: The caseTitle of the case
      type: String
    - contextPath: MSSPortal.Case.priority
      description: The priority of the case
      type: String
    - contextPath: MSSPortal.Case.resolutionNotes
      description: resolution notes
      type: String
    - contextPath: MSSPortal.Case.customerId
      description: The identifiant of the related customer
      type: Number
    - contextPath: MSSPortal.Case.caseSource
      description: Indicate if is a Cortex case or created manually
      type: String
    - contextPath: MSSPortal.Case.alertName
      description: Description for Cortex created cases and Alert Name for manually
        created cases
      type: String
    - contextPath: MSSPortal.Case.id
      description: The identifiant of the case
      type: Number
    - contextPath: MSSPortal.Case.createdAt
      description: the creation time of the case
      type: Unknown
    - contextPath: MSSPortal.Case.createdBy
      description: The case creator
      type: String
    - contextPath: MSSPortal.Case.updatedAt
      description: The last modification time of the case
      type: Unknown
    - contextPath: MSSPortal.Case.updatedBy
      description: The last case updator
      type: String
    - contextPath: MSSPortal.Case.serviceComponent
      description: The component of service for the case ex SOC
      type: String
    - contextPath: MSSPortal.Case.incidentTime
      description: The incident time of the case
      type: Unknown
    - contextPath: MSSPortal.Case.incidentBy
      description: The user who set the case as incident
      type: String
    - contextPath: MSSPortal.Case.nbTelusPendingTasks
      description: Number of pending tasks accountable for TELUS
      type: Number
    - contextPath: MSSPortal.Case.nbTelusUnreadTaskComments
      description: Number of task comments unread by TELUS
      type: Number
    - contextPath: MSSPortal.Case.nbCustomerClosedTasks
      description: Number of closed tasks accountable for Customer
      type: Number
    - contextPath: MSSPortal.Case.nbCustomerTasks
      description: Number of tasks accountable for Customer
      type: Number
    - contextPath: MSSPortal.Case.resolvedAt
      description: Resolution time of the task
      type: Unknown
    - contextPath: MSSPortal.Case.resolvedBy
      description: User who resolved the task
      type: String
    - contextPath: MSSPortal.Case.sourceCreatedAt
      description: The creation time from the source (optional)
      type: Unknown
    - contextPath: MSSPortal.Case.firstAcknowledgmentAt
      description: The time of the first acknowledgement (optional)
      type: Unknown
    - contextPath: MSSPortal.Case.firstAssignmentAt
      description: The time of the first assignment (optional)
      type: Unknown
    - contextPath: MSSPortal.Case.firstResolutionAt
      description: The first resolution time
      type: Unknown
    - contextPath: MSSPortal.Case.firstCustomerTaskCreatedAt
      description: The time the first customer task was created (optional)
      type: Unknown
    - contextPath: MSSPortal.Case.firstTelusTaskResolvedAt
      description: The time the first TELUS task was resolved (optional)
      type: Unknown
    - contextPath: MSSPortal.Case.firstCustomerIncidentTaskCreatedAt
      description: The time the first customer task was created after promoting as
        incident (optional)
      type: Unknown
    - contextPath: MSSPortal.Case.firstTelusIncidentTaskResolvedAt
      description: The time the first TELUS task was resolved after promoting as incident
        (optional)
      type: Unknown
  - arguments:
    - description: playbook ID to return
      name: id
      required: true
    description: 'mssportal-get-playbook command: Returns a MSSPortal playbook'
    name: mssportal-get-playbook
    outputs:
    - contextPath: MSSPortal.Playbook.id
      description: Playbook id
      type: Number
    - contextPath: MSSPortal.Playbook.createdAt
      description: The creation time
      type: Unknown
    - contextPath: MSSPortal.Playbook.createdBy
      description: The principal who created
      type: string
    - contextPath: MSSPortal.Playbook.updatedAt
      description: The last modification time
      type: Unknown
    - contextPath: MSSPortal.Playbook.updatedBy
      description: The principal who last modified
      type: String
    - contextPath: MSSPortal.Playbook.name
      description: The name of the playbook
      type: String
    - contextPath: MSSPortal.Playbook.description
      description: The description of the playbook
      type: String
    - contextPath: MSSPortal.Playbook.playbookTasks
      description: undefined
      type: Unknown
  - arguments:
    - description: Task Id
      name: id
      required: true
    description: 'mssportal-get-task command: Returns a MSSPortal task'
    name: mssportal-get-task
    outputs:
    - contextPath: MSSPortal.Task.id
      description: Playbook id
      type: Number
    - contextPath: MSSPortal.Task.name
      description: name of the task
      type: String
    - contextPath: MSSPortal.Task.description
      description: description of the task
      type: String
    - contextPath: MSSPortal.Task.caseId
      description: case no.
      type: Number
    - contextPath: MSSPortal.Task.customerId
      description: undefined
      type: Number
    - contextPath: MSSPortal.Task.accountable
      description: who is accountable TELUS or customer
      type: String
    - contextPath: MSSPortal.Task.status
      description: status of task
      type: String
    - contextPath: MSSPortal.Task.acknowledged
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.priority
      description: priority of task
      type: Unknown
    - contextPath: MSSPortal.Task.phase
      description: undefined
      type: String
    - contextPath: MSSPortal.Task.telusPrime
      description: The Telus user accountable for the case
      type: String
    - contextPath: MSSPortal.Task.dueDate
      description: due date of case
      type: Unknown
    - contextPath: MSSPortal.Task.createdAt
      description: time of creation
      type: Unknown
    - contextPath: MSSPortal.Task.createdBy
      description: who created the task
      type: Unknown
    - contextPath: MSSPortal.Task.updatedAt
      description: last updated
      type: Unknown
    - contextPath: MSSPortal.Task.updatedBy
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.acknowledgedAt
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.acknowledgedBy
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.caseTitle
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.playbookName
      description: name of playbook
      type: String
    - contextPath: MSSPortal.Task.comments
      description: undefined
      type: Unknown
    - contextPath: MSSPortal.Task.unreadCommentsByCustomer
      description: no. of unread comments by customer
      type: Number
    - contextPath: MSSPortal.Task.unreadCommentsByTelus
      description: no. of unread comments by TELUS
      type: Number
    - contextPath: MSSPortal.Task.modifiedByTelus
      description: notify customer when TELUS updates task (true or false)
      type: Unknown
    - contextPath: MSSPortal.Task.resolvedAt
      description: Resolution time of the task
      type: Unknown
    - contextPath: MSSPortal.Task.resolvedBy
      description: undefined
      type: String
  - arguments:
    - description: Case ID
      name: id
      required: true
    - description: The status of the case. Ex) PENDING, IN_PROGRESS, CLOSED;
      name: status
      required: true
    - description: The Telus user accountable for the case. Ex) https://mssportal.telus.com/api/users/1
      name: telusPrime
      required: true
    - description: The description of the case. Ex) This is a case description
      name: description
      required: true
    - description: The caseTitle of the case. Ex) This is a case title.
      name: caseTitle
      required: true
    - description: The priority of the case. Ex) VERY_LOW, LOW, MEDIUM, HIGH, CRITICAL
      name: priority
      required: true
    - description: |-
        The resolution notes of the case. Ex) This is a resolution notes
            Returns:
      name: resolutionNotes
      required: true
    description: 'mssportal-update-case command: Returns a MSSPortal case '
    name: mssportal-update-case
  - arguments:
    - description: Case ID
      name: id
      required: true
    - description: Resolution notes
      name: resolutionNotes
      required: true
    description: 'mssportal-resolve-case command:  resolve case in MSS Portal'
    name: mssportal-resolve-case
  - arguments:
    - description: task id
      name: id
    - description: name of task
      name: name
    - description: description of task
      name: description
    - description: id of case
      name: caseId
    - description: TELUS or customer
      name: accountable
    - description: available values CONTAIN, INVESTIGATE, ERADICATE, LESSONS_LEARNED
      name: phase
    - description: available values critical, high, medium, low
      name: priority
    - description: available values pending, in_progress, closed
      name: status
    - description: TELUS member accountable for task
      name: telusPrime
    - description: Start time of source task creation date . Format) 2022-07-18T13:44:36.769Z
        (ISO
      name: createdAt_from
    - description: End time of source task creation date . Format) 2022-07-18T13:44:36.769Z
        (ISO
      name: createdAt_to
    - description: dueDate of task
      name: dueDate
    - description: Customer's ID ex)123475
      name: customerId
    - description: title of case
      name: caseTile
    - description: keyword
      name: searchText
    - description: Start time of task resolution
      name: resolvedAt_from
    - description: End time of task resolution
      name: resolvedAt_to
    - description: undefined
      name: resolvedBy
    - description: undefined
      name: sort
    - default: true
      description: undefined
      name: offset
    - default: true
      description: undefined
      name: limit
    description: mssportal-find-tasks find tasks
    name: mssportal-find-tasks
    outputs:
    - contextPath: MSSPortal.Task.totalPages
      description: undefined
      type: integer
    - contextPath: MSSPortal.Task.totalElements
      description: total number of tasks
      type: integer
    - contextPath: MSSPortal.Task.number
      description: undefined
      type: integer
    - contextPath: MSSPortal.Task.sort
      description: unknown
      type: unknown
    - contextPath: MSSPortal.Task.content
      description: task information (id, name, description, caseId, customerId, status,
        comments, etc)
      type: unknown
    - contextPath: MSSPortal.Task.numberOfElements
      description: undefined
      type: integer
    - contextPath: MSSPortal.Task.pageable
      description: undefined
      type: unknown
    - contextPath: MSSPortal.Task.first
      description: undefined
      type: boolean
    - contextPath: MSSPortal.Task.last
      description: undefined
      type: boolean
    - contextPath: MSSPortal.Task.empty
      description: undefined
      type: boolean
  - arguments:
    - description: case ID to return
      name: caseId
      required: true
    - description: playbook ID to return
      name: playbookId
      required: true
    - description: Task ids to exclude
      name: excludeTaskIds
    description: 'mssportal-activate-playbook command: activate portal playbook in
      the case'
    name: mssportal-activate-playbook
  dockerimage: demisto/python3:3.10.5.31797
  isremotesyncin: true
  isremotesyncout: true
  runonce: true
  script: |
    register_module_line('MSS Portal - MDR', 'start', __line__())


    # import json
    import urllib3
    # import dateparser
    import traceback
    # from typing import Any, Dict, Tuple, List, Optional, Union, cast
    from typing import Any, Dict

    # Disable insecure warnings
    urllib3.disable_warnings()


    ''' CONSTANTS '''


    DATE_FORMAT = '%Y-%m-%dT%H:%M:%SZ'

    ''' CLIENT CLASS '''


    class Client(BaseClient):
        """Client class to interact with the service API

        This Client implements API calls, and does not contain any Demisto logic.
        Should only do requests and return data.
        It inherits from BaseClient defined in CommonServer Python.
        Most calls use _http_request() that handles proxy, SSL verification, etc.
        For this MSSPortal implementation, no special attributes defined
        """

        def getCurrentUserIdentity(self) -> Dict[str, Any]:
            """Gets customer user's identity
            This methods will be used mainly to test API connectivity
            """

            return self._http_request('get', '/identities/current')

        def get_alert(self, id: str) -> Dict[str, Any]:
            """Gets a specific MSSPortal alert by id

            :type id: ``str``
            :param id: id of the alert to return

            :return: dict containing the alert as returned from the API
            :rtype: ``Dict[str, Any]``
            """

            return self._http_request('get', f'/alerts/{id}')

        def get_case(self, id: str) -> Dict[str, Any]:
            """Get a specific MSSPortal case by id

            :type id: ``str``
            :param id: id of the case to acknowledge

            :return: string from the API call
            :rtype: ``str``
            """

            return self._http_request('get', f'/cases/{id}')

        def find_task(self, data: Dict[str, Any]) -> Dict[str, Any]:
            """Get a specific MSSPortal case by id

            :return: string from the API call
            :rtype: ``str``
            """

            return self._http_request('get', '/tasks', json_data=data)

        def update_case(self, id: str, data: Dict[str, Any]) -> str:
            """Updates a specific MSSPortal case by id

            :type id: ``str``
            :param id: id of the case to update

            :return: string from the API call
            :rtype: ``str``
            """

            return self._http_request('put', f'/cases/{id}', json_data=data, resp_type='text')

        def acknowledge_case(self, id: str) -> str:
            """Acknowledge a specific MSSPortal case by id

            :type id: ``str``
            :param id: id of the case to acknowledge

            :return: string from the API call
            :rtype: ``str``
            """

            return self._http_request('put', f'/cases/{id}/acknowledgement', resp_type='text')

        def get_playbook(self, id: str) -> Dict[str, Any]:
            """Get a specific MSSPortal playbook by id

            :type id: ``str``
            :param id: id of the playbook

            :return: string from the API call
            :rtype: ``Dict[str, Any]``
            """

            return self._http_request('get', f'/playbooks/{id}')

        def find_playbook(self, searchParams: Dict[str, Any]) -> Dict[str, Any]:
            """Get a specific MSSPortal playbook by id

            :type data: ``Dict[str, Any]``
            :param data: search parameter values

            :return: string from the API call
            :rtype: ``Dict[str, Any]``
            """
            return self._http_request('get', '/playbooks', params=searchParams)

        def get_task(self, id: str) -> Dict[str, Any]:
            """Get a specific MSSPortal task by id

            :type id: ``str``
            :param id: id of the case to acknowledge

            :return: string from the API call
            :rtype: ``Dict[str, Any]``
            """

            return self._http_request('get', f'/tasks/{id}')

        def create_task(self, data: Dict[str, Any]) -> Dict[str, Any]:
            """create a MSSPortal task

            :type data: `Dict[str, Any]
            :param data: information to create task

            :return: string from the API call
            :rtype: ``Dict[str, Any]``
            """
            return self._http_request('post', '/tasks', json_data=data)

        def create_case(self, data: Dict[str, Any]) -> Dict[str, Any]:
            """Create a specific MSSPortal case

            :return: string from the API call
            :rtype: ``Dict[str, Any]``
            """
            return self._http_request('post', '/cases', json_data=data)

        def create_alert(self, data: Dict[str, Any]) -> Dict[str, Any]:
            """Gets a specific MSSPortal alert by id
            :type: dict containing the alert
            :param ``Dict[str, Any]``

            :return: dict containing the alert as returned from the API
            :rtype: ``Dict[str, Any]``
            """

            return self._http_request('post', '/alerts', json_data=data)

        def create_playbook(self, data: Dict[str, Any]) -> Dict[str, Any]:
            """Gets a specific MSSPortal alert by id
            :type: dict containing the alert
            :param ``Dict[str, Any]``

            :return: dict containing the alert as returned from the API
            :rtype: ``Dict[str, Any]``
            """

            return self._http_request('post', '/playbooks', json_data=data)

        def resolve_case(self, id: str, data: Dict[str, Any]) -> str:
            """Resolve a MSSPortal case
            :type: dict containing the alert
            :param ``Dict[str, Any]``

            :return: dict containing the alert as returned from the API
            :rtype: ``str``
            """
            return self._http_request('put', f'/cases/{id}/resolution', json_data=data, resp_type='text')

        def confirm_incident(self, id: str) -> str:
            """confirms the case as a true incident

            :type id: ``str``
            :param id: id of the case to confirm as a true incident

            :return: string from the API call
            :rtype: ``str``
            """

            return self._http_request('put', f'/cases/{id}/incident', resp_type='text')

        def activate_playbook(self, caseId: str, playbookId: str, excludeTaskIds: str) -> str:
            """confirms the case as a true incident

            :type id: ``str``
            :param id: id of the case to confirm as a true incident

            :return: string from the API call
            :rtype: ``str``
            """
            data = []
            if excludeTaskIds:
                data = excludeTaskIds.replace(" ", "").split(",")

            return self._http_request('post', f'/cases/{caseId}/playbooks/{playbookId}', json_data=data, resp_type='text')


    ''' HELPER FUNCTIONS '''


    ''' COMMAND FUNCTIONS '''


    def test_module(client: Client) -> str:
        """Tests API connectivity

        Returning 'ok' indicates that the integration works like it is supposed to.
        Connection to the service is successful.
        Raises exceptions if something goes wrong.

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type name: ``str``
        :param name: name to append to the 'Hello' string

        :return: 'ok' if test passed, anything else will fail the test.
        :rtype: ``str``
        """

        # INTEGRATION DEVELOPER TIP
        # Client class should raise the exceptions, but if the test fails
        # the exception text is printed to the Cortex XSOAR UI.
        # If you have some specific errors you want to capture (i.e. auth failure)
        # you should catch the exception here and return a string with a more
        # readable output (for example return 'Authentication Error, API Key
        # invalid').
        # Cortex XSOAR will print everything you return different than 'ok' as
        # an error
        try:
            client.getCurrentUserIdentity()
        except DemistoException as e:
            if 'Forbidden' in str(e):
                return 'Authorization Error: make sure API Key is correctly set'
            else:
                raise e
        return 'ok'


    def get_alert_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-get-alert command: Returns a MSSPortal alert

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['id']`` alert ID to return

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert

        :rtype: ``CommandResults``
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')

        alert = client.get_alert(id)

        # tableToMarkdown() is defined is CommonServerPython.py and is used very
        # often to convert lists and dicts into a human readable format in markdown
        readable_output = tableToMarkdown(f'MSSPortal Alert {id}', alert)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Alert',
            outputs_key_field='id',
            outputs=alert
        )


    def update_case_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-update-case command: Returns a MSSPortal case

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['id']`` alert ID to return

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains the result of case update

        :rtype: ``CommandResults``
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')

        json_data: Dict[str, Any] = {}

        status = args.get('status')
        if not status:
            json_data['status'] = status
        telusPrime = args.get('telusPrime')
        if not status:
            json_data['telusPrime'] = telusPrime
        description = args.get('description')
        if not status:
            json_data['description'] = description
        caseTitle = args.get('caseTitle')
        if not status:
            json_data['caseTitle'] = caseTitle
        priority = args.get('priority')
        if not priority:
            json_data['priority'] = priority
        resolutionNotes = args.get('resolutionNotes')
        if not resolutionNotes:
            json_data['resolutionNotes'] = resolutionNotes

        client.update_case(id, json_data)

        return CommandResults(
            readable_output=f'MSSPortal Case {id} updated'
        )


    def acknowledge_case_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-acknowledge-case command: change case status from pending to investigate

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['id']`` case ID to return

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains the result of the case acknowledgement

        :rtype: ``CommandResults``
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')

        client.acknowledge_case(id)

        return CommandResults(
            readable_output=f'MSSPortal Case {id} acknowledged'
        )


    def resolve_case_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-resolve-alert command: Returns a MSSPortal case

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['id']`` case ID to return

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert

        :rtype: ``CommandResults``
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')
        resolutionNotes = args.get('resolutionNotes', None)
        if not resolutionNotes:
            raise ValueError('resolutionNotes not specified')

        client.resolve_case(id, {"resolutionNotes": resolutionNotes})

        return CommandResults(
            readable_output=f'MSSPortal Case {id} resolved - {resolutionNotes}'
        )


    def create_alert_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-get-alert command: Returns a MSSPortal alert

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['alert_id']`` alert ID to return

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert

        :rtype: ``CommandResults``
        """

        sourceId = args.get('sourceId')
        if not sourceId:
            raise ValueError('sourceId not specified')
        sourceCreatedAt = args.get('sourceCreatedAt')
        if not sourceCreatedAt:
            raise ValueError('sourceCreatedAt not specified')
        sourceModifiedAt = args.get('sourceModifiedAt')
        if not sourceModifiedAt:
            raise ValueError('sourceModifiedAt not specified')
        sourceAlertId = args.get('sourceAlertId')
        if not sourceAlertId:
            raise ValueError('sourceAlertId not specified')
        sourceRaw = args.get('sourceRaw', '{}')
        if not sourceRaw:
            raise ValueError('sourceRaw not specified')
        severity = args.get('severity')
        if not severity:
            raise ValueError('severity not specified')
        customerId = args.get('customerId',)
        if not customerId:
            raise ValueError('customerId not specified')
        investigationCaseId = args.get('investigationCaseId')
        name = args.get('name')
        if not name:
            raise ValueError('name not specified')

        json_data = {
            "sourceId": sourceId,
            "sourceCreatedAt": sourceCreatedAt,
            "sourceModifiedAt": sourceModifiedAt,
            "sourceAlertId": sourceAlertId,
            "sourceRaw": json.dumps(sourceRaw),
            "severity": severity,
            "customerId": customerId,
            "investigationCaseId": investigationCaseId,
            "name": name
        }

        caseDescription = args.get('caseDescription')
        if caseDescription:
            json_data['caseDescription'] = caseDescription
        caseTitle = args.get('caseTitle')
        if caseTitle:
            json_data['caseTitle'] = caseTitle
        detailHtml = args.get('detailHtml')
        if detailHtml:
            json_data['detailHtml'] = detailHtml

        alert = client.create_alert(json_data)

        # INTEGRATION DEVELOPER TIP
        # We want to convert the "created" time from timestamp(s) to ISO8601 as
        # Cortex XSOAR customers and integrations use this format by default

        # tableToMarkdown() is defined is CommonServerPython.py and is used very
        # often to convert lists and dicts into a human readable format in markdown

        readable_output = tableToMarkdown(f'MSSPortal Alert {alert["id"]}', alert)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Alert',
            outputs_key_field='id',
            outputs=alert
        )


    def find_task_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-find-task command: Returns a MSSPortal task

         Args:
            client(Client): MSSPortal client to use
            task_id: task id
            name: name of the alert
            description: description of task
            caseId: case id
            accountable: Telus or customer
            phase: phase of task example: INVESTIGATE
            priority: priority of task (HIGH, MEDIUM, LOW)
            status: status of the task example: PENDING
            telusPrime: TELUS member accountable for task
            createdAt_from:
            createdAt_to: The creation time of the alert
            dueDate: due date of task
            customerId:
            caseTitle:
            searchText:
            resolvedAt_to:
            resolvedBy:
            sort:
            offset:
            limit:limit


        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert


        Context Outputs:
            id (int): Alert ID.
            status(str): status of case example: PENDING


        """

        task_id = args.get('id')
        name = args.get('name')
        description = args.get('description')
        case_id = args.get('caseId')
        accountable = args.get('accountable')
        phase = args.get('phase')
        priority = args.get('priority')
        status = args.get('status')
        telusPrime = args.get('telusPrime')
        createdAt_from = args.get('createdAt_from')
        createdAt_to = args.get('createdAt_to')
        dueDate = args.get('dueDate')
        customerId = args.get('customerId')
        caseTitle = args.get('caseTitle')
        searchText = args.get('searchText')
        resolvedAt_to = args.get('resolvedAt_to')
        resolvedBy = args.get('resolvedBy')
        sort = args.get('sort')
        offset = args.get('offset')
        limit = args.get('limit')

        json_data = {
            "id": task_id,
            "name": name,
            'description': description,
            "caseId": case_id,
            "accountable": accountable,
            "phase": phase,
            "priority": priority,
            "status": status,
            "telusPrime": telusPrime,
            "createdAt_from": createdAt_from,
            "createdAt_to": createdAt_to,
            "dueDate": dueDate,
            "customerId": customerId,
            "caseTitle": caseTitle,
            "searchText": searchText,
            "resolvedAt_to": resolvedAt_to,
            "resolvedBy": resolvedBy,
            "sort": sort,
            "offset": offset,
            "limit": limit
        }

        tasks = client.find_task(json_data)

        readable_output = tableToMarkdown('MSSPortal Task founded', tasks)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Task',
            outputs_key_field='id',
            outputs=tasks
        )


    def get_case_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-get-case command: Returns a MSSPortal case

        Args:
            client(Client): MSSPortal client to use
            id: Case ID to return

        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert


        Context Outputs:
            id (int): Alert ID.
            status(str): status of case example: PENDING
            telusPrime(str): The Telus user accountable for the case
            description(str): The description of the case
            caseTitle(str): The caseTitle of the case
            priority(str): The priority of the case
            resolutionNotes(str): resolution notes
            customerId(int): The identifiant of the related customer
            caseSource(str): Indicate if is a Cortex case or created manually
            alertName(str): Description for Cortex created cases and Alert Name for manually created cases
            id(int): The identifiant of the case
            createdAt(date): the creation time of the case
            createdBy(str): The case creator
            updatedAt(date): The last modification time of the case
            updatedBy(str): The last case updator
            serviceComponent(str): The component of service for the case ex SOC
            incident(boolean) Indicates if the case has an incident (TRUE OR FALSE)
            incidentTime(date): The incident time of the case
            incidentBy(str): The user who set the case as incident
            nbTelusPendingTasks(int): Number of pending tasks accountable for TELUS
            nbTelusUnreadTaskComments(int): Number of task comments unread by TELUS
            nbCustomerClosedTasks(int): Number of closed tasks accountable for Customer
            nbCustomerTasks(int): Number of tasks accountable for Customer
            resolvedAt(date): Resolution time of the task
            resolvedBy(str):User who resolved the task
            sourceCreatedAt(date): The creation time from the source (optional)
            firstAcknowledgmentAt(date): The time of the first acknowledgement (optional)
            firstAssignmentAt(date): The time of the first assignment (optional)
            firstResolutionAt(date): The first resolution time
            firstCustomerTaskCreatedAt(date): The time the first customer task was created (optional)
            firstTelusTaskResolvedAt(date): The time the first TELUS task was resolved (optional)
            firstCustomerIncidentTaskCreatedAt(date): The time the first customer task was created (optional)
            firstTelusIncidentTaskResolvedAt(date): The time the first TELUS task was resolved after promoting as incident (optional)
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')

        case = client.get_case(id)

        # tableToMarkdown() is defined is CommonServerPython.py and is used very
        # often to convert lists and dicts into a human readable format in markdown
        readable_output = tableToMarkdown(f'MSSPortal Case {id}', case)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Case',
            outputs_key_field='id',
            outputs=case
        )


    def find_playbook_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-find-playbook command: Returns MSSPortal playbook
        """

        searchParams = {}

        playbookId = args.get('playbookId')
        if playbookId:
            searchParams['playbookId'] = playbookId
        createdAt_from = args.get('createdAt_from')
        if createdAt_from:
            searchParams['createdAt_from'] = createdAt_from
        createdAt_to = args.get('createdAt_to')
        if createdAt_to:
            searchParams['createdAt_to'] = createdAt_to
        updatedAt_from = args.get('updatedAt_from')
        if updatedAt_from:
            searchParams['updatedAt_from'] = updatedAt_from
        updatedAt_to = args.get('updatedAt_to')
        if updatedAt_to:
            searchParams['updatedAt_to'] = updatedAt_to
        searchText = args.get('searchText')
        if searchText:
            searchParams['searchText'] = searchText
        sort = args.get('sort')
        if sort:
            searchParams['sort'] = sort
        offset = args.get('offset')
        if offset:
            searchParams['offset'] = offset
        limit = args.get('limit')
        if limit:
            searchParams['limit'] = limit

        playbooks = client.find_playbook(searchParams)

        readable_output = tableToMarkdown(f'MSSPortal Playbook by id - {playbookId}', playbooks)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Playbook',
            outputs_key_field='id',
            outputs=playbooks
        )


    def get_playbook_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-get-playbook command: Returns a MSSPortal playbook

        Args:
            client(Client): MSSPortal client to use
            id:  playbook ID to return

        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert


        Context Outputs:
            id(int): Playbook id
            createdAt(date): The creation time
            createdBy(str): The principal who created
            updatedAt(date): The last modification time
            updatedBy(str): The principal who last modifed
            name(str): The name of the playbook
            description(str): The description of the playbook
            playbookTasks(unknown): undefined
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')

        playbook = client.get_playbook(id)

        # tableToMarkdown() is defined is CommonServerPython.py and is used very
        # often to convert lists and dicts into a human readable format in markdown
        readable_output = tableToMarkdown(f'MSSPortal Playbook {id}', playbook)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Playbook',
            outputs_key_field='id',
            outputs=playbook
        )


    def create_playbook_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-create-playbook command: Returns a MSSPortal playbook

        Args:
            client(Client): MSSPortal client to use
            name: playbook name
            description: playbook description

        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert

        Context Outputs:
            id(int): Playbook id
            createdAt(date): The creation time
            createdBy(str): The principal who created
            updatedAt(date): The last modification time
            updatedBy(str): The principal who last modified
            name(str): The name of the playbook
            description(str): The description of the playbook
            playbookTasks(unknown): undefined
        """
        name = args.get('name')
        description = args.get('description')

        json_data: Dict[str, Any] = {}

        json_data['name'] = name
        json_data['description'] = description

        playbook = client.create_playbook(json_data)

        readable_output = tableToMarkdown('MSSPortal Playbook', playbook)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Playbook',
            outputs_key_field='id',
            outputs=playbook
        )


    def get_task_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-get-task command: Returns a MSSPortal task

        Args:
            client(Client): MSSPortal client to use
            id:  Task Id


        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert
        Context Outputs:
            id(int): Playbook id
            name(str): name of the task
            description(str):description of the task
            caseId(int): case no.
            customerId(int): undefined
            accountable(string): who is accountable TELUS or customer
            status(str): status of task
            acknowledged(boolean): undefined
            priority(string): priority of task
            phase(str): undefined
            telusPrime(str): The Telus user accountable for the case
            dueDate(date): due date of case
            createdAt(date): time of creation
            createdBy(date): who created the task
            updatedAt(date): last updated
            updatedBy(date): undefined
            acknowledgedAt(string): undefined
            acknowledgedBy(string): undefined
            caseTitle(string): undefined
            abouttoExpireThresholdInDays(unknown)
            playbookName(str): name of playbook
            comments(undefined): undefined
            unreadCommentsByCustomer(int): no. of unread comments by customer
            unreadCommentsByTelus(int): no. of unread comments by TELUS
            modifiedbyTelus(boolean): notify customer when TELUS updates task (true or false)
            resolvedAt(date):  Resolution time of the task
            resolvedBy(str): undefined
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')
        task = client.get_task(id)

        # INTEGRATION DEVELOPER TIP
        # We want to convert the "created" time from timestamp(s) to ISO8601 as
        # Cortex XSOAR customers and integrations use this format by default

        # tableToMarkdown() is defined is CommonServerPython.py and is used very
        # often to convert lists and dicts into a human readable format in markdown

        readable_output = tableToMarkdown(f'MSSPortal Task {id}', task)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Task',
            outputs_key_field='id',
            outputs=task
        )


    def create_task_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-create-task command: Returns a MSSPortal task

        Args:
            client(Client): MSSPortal client to use
            id:  Task Id
            name: Task name
            description: Task description
            caseId: Id of the case
            accountable: Telus user accountable for task example: TELUS
            telusPrime: The Telus user accountable for the case example: https://mssportal.telus.com/api/users/1
            priority: The priority of the task ex HIGH, MEDIUM, LOW
            phase: The phase of the task ex Investigate
            status: The status of the task ex pending
            dueDate: The due date of the task
            aboutToExpireThresholdInDays: The threshold in days to notify when task will expire
            modifiedByTelus: Should the customer be notified when TELUS modifies a task (ex false or true)

        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert

        Context Outputs:
            id(int): Playbook id
            name(str): name of the task
            description(str): description of the task
            caseId(int): case no.
            customerId(int): undefined
            accountable(string): who is accountable TELUS or customer
            status(str): status of task
            acknowledged(boolean): undefined
            priority(string): priority of task
            phase(str): undefined
            telusPrime(str): The Telus user accountable for the case
            dueDate(date): due date of case
            createdAt(date): time of creation
            createdBy(date): who created the task
            updatedAt(date): last updated
            updatedBy(date): undefined
            acknowledgedAt(string): undefined
            acknowledgedBy(string): undefined
            caseTitle(string): undefined
            abouttoExpireThresholdInDays()
            playbookName(str): name of playbook
            comments(undefined): undefined
            unreadCommentsByCustomer(int): no. of unread comments by customer
            unreadCommentsByTelus(int): no. of unread comments by TELUS
            modifiedbyTelus(boolean): notify customer when TELUS updates task (true or false)
            resolvedAt(date):  Resolution time of the task
            resolvedBy(str): undefined


        """
        json_data = {}

        name = args.get('name')
        if name:
            json_data['name'] = name
        description = args.get('description')
        if description:
            json_data['description'] = description
        caseId = args.get('caseId')
        if caseId:
            json_data['caseId'] = caseId
        accountable = args.get('accountable')
        if accountable:
            json_data['accountable'] = accountable
        telusPrime = args.get("telusPrime")
        if telusPrime:
            json_data['telusPrime'] = telusPrime
        status = args.get("status")
        if status:
            json_data['status'] = status
        phase = args.get("phase")
        if description:
            json_data['phase'] = phase
        dueDate = args.get('dueDate')
        if dueDate:
            json_data['dueDate'] = dueDate
        aboutToExpireThresholdInDays = args.get('aboutToExpireThresholdInDays')
        if aboutToExpireThresholdInDays:
            json_data['aboutToExpireThresholdInDays'] = aboutToExpireThresholdInDays
        modifiedByTelus = args.get('modifiedByTelus')
        if modifiedByTelus:
            json_data['modifiedByTelus'] = modifiedByTelus

        task = client.create_task(json_data)

        readable_output = tableToMarkdown(f'MSSPortal Task {task["id"]}', task)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Task',
            outputs_key_field='id',
            outputs=task
        )


    def create_case_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-get-alert command: Returns a MSSPortal alert

        Args:
            client(Client): MSSPortal client to use
            status: customer ID to return
            telusPrime: Telus user accountable for case
            description: description of case
            caseTitle: Title of case
            priority: Priority of case (HIGH, MEDIUM, LOW)
            resolutionNotes: resolution notes of the case
            customerId
            caseSource
            alertName
            serviceComponent


        Returns:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains an alert

        Context Outputs:
            status(str): status of case
            telusPrime(str): telus user accountable for case
            description(str): description of case
            caseTitle(str): title of case
            priority(str): severity of case (HIGH, MEIDUM, LOW )
            resolutionNotes(str): resolution notes
            customerId(unknown): undefined
            caseSource(unknown): undefined
            alertName(str): undefined
            id(int): id of case
            createdAt(date): date of creation
            createdBy(str): who created the case
            updatedAt(date): modification date
            updatedBy(str): undefined
            serviceComponent(unknown): undefined
            incident(boolean): true incident (true or false)
            incidentTime(date): undefined
            nbTelusPendingTasks(int): no. of pending tasks for TELUS
            nbTelusUnreadTaskComments(int): no. of unread tasks
            nbCustomerClosedTasks(int): closed customer tasks
            nbCustomerTasks(Int): tasks customer responsible for
            resolvedAt(date): undefined
            resolvedBy(str): undefined
            sourceCreatedAt(date): undefined
            firstAcknowledgmentAt(date): undefined
            firstAssignmentAt(date): undefined
            firstResolutionAt(unknown): undefined
            firstCustomerTaskCreatedAt(unknown): undefined
            firstTelusTaskResolvedAt(unknown): undefined
            firstCustomerIncidentTaskCreatedAt(unknown): undefined
            firstTelusIncidentTaskResolvedAt(unknown): undefined
        """

        description = args.get('description', None)
        if not description:
            raise ValueError('description not specified')
        caseTitle = args.get('caseTitle', None)
        if not description:
            raise ValueError('caseTitle not specified')
        priority = args.get('priority', None)
        if not description:
            raise ValueError('priority not specified')
        customerId = args.get('customerId', None)
        if not description:
            raise ValueError('customerId not specified')
        caseSource = args.get('caseSource', None)
        if not description:
            raise ValueError('caseSource not specified')
        serviceComponent = args.get('serviceComponent', None)
        if not description:
            raise ValueError('serviceComponent not specified')

        json_data = {
            'description': description,
            'caseTitle': caseTitle,
            'priority': priority,
            'customerId': customerId,
            'caseSource': caseSource,
            'serviceComponent': serviceComponent
        }

        status = args.get('status')
        if status:
            json_data['status'] = status
        telusPrime = args.get('telusPrime')
        if status:
            json_data['telusPrime'] = telusPrime
        resolutionNotes = args.get('resolutionNotes')
        if resolutionNotes:
            json_data['resolutionNotes'] = resolutionNotes
        alertName = args.get('alertName')
        if alertName:
            json_data['alertName'] = alertName

        case = client.create_case(json_data)

        # INTEGRATION DEVELOPER TIP
        # We want to convert the "created" time from timestamp(s) to ISO8601 as
        # Cortex XSOAR customers and integrations use this format by default

        # tableToMarkdown() is defined is CommonServerPython.py and is used very
        # often to convert lists and dicts into a human readable format in markdown

        readable_output = tableToMarkdown(f'MSSPortal Case {case["id"]}', case)

        return CommandResults(
            readable_output=readable_output,
            outputs_prefix='MSSPortal.Case',
            outputs_key_field='id',
            outputs=case
        )


    def confirm_incident_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-confirm-incident command: confirms the case as a true incident

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['id']`` case ID to return

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains the result of the case acknowledgement

        :rtype: ``CommandResults``
        """

        id = args.get('id', None)
        if not id:
            raise ValueError('id not specified')

        client.confirm_incident(id)

        return CommandResults(
            readable_output=f'MSSPortal Case {id} confirmed as a true incident'
        )


    def activate_playbook_command(client: Client, args: Dict[str, Any]) -> CommandResults:
        """mssportal-activate-playbook command: activate the playbook in the case

        :type client: ``Client``
        :param Client: MSSPortal client to use

        :type args: ``Dict[str, Any]``
        :param args:
            all command arguments, usually passed from ``demisto.args()``.
            ``args['caseId']`` case ID to in which the playbook will be activated
            ``args['playbookId']`` playbook ID to activate in the case

        :return:
            A ``CommandResults`` object that is then passed to ``return_results``,
            that contains the result of the case acknowledgement

        :rtype: ``CommandResults``
        """

        caseId = args.get('caseId', None)
        if not caseId:
            raise ValueError('caseId not specified')
        playbookId = args.get('playbookId', None)
        if not playbookId:
            raise ValueError('playbookId not specified')
        excludeTaskIds = args.get('excludeTaskIds', None)

        client.activate_playbook(caseId, playbookId, excludeTaskIds)

        return CommandResults(
            readable_output=f'MSSPortal playbook {playbookId} was activated in the case {playbookId}'
        )


    ''' MAIN FUNCTION '''


    def main() -> None:
        """main function, parses params and runs command functions

        :return:
        :rtype:
        """

        api_key = demisto.params().get('api_key')

        # get the service API url
        base_url = urljoin(demisto.params()['url'], '/api/v1')

        # if your Client class inherits from BaseClient, SSL verification is
        # handled out of the box by it, just pass ``verify_certificate`` to
        # the Client constructor
        verify_certificate = not demisto.params().get('insecure', True)

        # if your Client class inherits from BaseClient, system proxy is handled
        # out of the box by it, just pass ``proxy`` to the Client constructor
        proxy = demisto.params().get('proxy', False)

        # INTEGRATION DEVELOPER TIP
        # You can use functions such as ``demisto.debug()``, ``demisto.info()``,
        # etc. to print information in the XSOAR server log. You can set the log
        # level on the server configuration
        # See: https://xsoar.pan.dev/docs/integrations/code-conventions#logging

        demisto.debug(f'Command being called is {demisto.command()}')
        try:
            headers = {
                'X-Lestrade-Key-ID': 'xsoar',
                'X-Lestrade-Key': api_key
            }
            client = Client(
                base_url=base_url,
                verify=verify_certificate,
                headers=headers,
                proxy=proxy)

            if demisto.command() == 'test-module':
                # This is the call made when pressing the integration Test button.
                result = test_module(client)
                return_results(result)

            elif demisto.command() == 'mssportal-get-alert':
                return_results(get_alert_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-create-alert':
                return_results(create_alert_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-get-case':
                return_results(get_case_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-update-case':
                return_results(update_case_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-acknowledge-case':
                return_results(acknowledge_case_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-confirm-incident':
                return_results(confirm_incident_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-create-case':
                return_results(create_case_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-resolve-case':
                return_results(resolve_case_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-get-playbook':
                return_results(get_playbook_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-find-playbook':
                return_results(find_playbook_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-create-playbook':
                return_results(create_playbook_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-activate-playbook':
                return_results(activate_playbook_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-get-task':
                return_results(get_task_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-create-task':
                return_results(create_task_command(client, demisto.args()))
            elif demisto.command() == 'mssportal-find-tasks':
                return_results(find_task_command(client, demisto.args()))

        # Log exceptions and return errors
        except Exception as e:
            demisto.error(traceback.format_exc())  # print the traceback
            return_error(f'Failed to execute {demisto.command()} command.\nError:\n{str(e)}')


    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('MSS Portal - MDR', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: MSS Portal - MDR
